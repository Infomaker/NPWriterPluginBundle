!function(e){function t(a){if(n[a])return n[a].exports;var i=n[a]={exports:{},id:a,loaded:!1};return e[a].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}var i=n(1),r=a(i),o=n(6),s=a(o),l=n(9),u=a(l),d=n(18),c=a(d),p=n(24),f=a(p),h=n(33),b=a(h);!function(){console.log("Hello"),(0,r["default"])(),(0,s["default"])(),(0,u["default"])(),(0,f["default"])(),(0,c["default"])(),(0,b["default"])()}()},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),r=a(i),o=writer,s=o.registerPlugin;t["default"]=function(){s?s(r["default"]):console.error("Register method not yet available")}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=a(i);t["default"]={name:"skeleton",id:"se.infomaker.skeleton",configure:function(e){e.addComponentToSidebarWithTabId(this.id,"main",r["default"]),e.addLabel("skeleton-title",{en:"Skeleton plugin",sv:"Skelettplugin"})}}},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(4),l=n(5),u=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),o(t,[{key:"didMount",value:function(){}},{key:"render",value:function(e){return e("div").css("padding","1rem 2rem").css("height","200px").append("HELLO WORLD")}},{key:"onClose",value:function(e){return console.log("Close"),!0}}]),t}(s.Component),d=function(e){function t(){var e;a(this,t);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)))}return r(t,e),o(t,[{key:"dispose",value:function(){console.log("Dispose")}}]),o(t,[{key:"getInitialState",value:function(){return{clickCount:0}}},{key:"didMount",value:function(){}},{key:"render",value:function(e){var t=this,n=e("div");n.append(e("h2").append(this.getLabel("skeleton-title"))),n.append(e("p").append(String(this.state.clickCount)));var a=this.state.clickCount,i=e("button").on("click",function(){t.setState({clickCount:a+1})}).append("Click me"),r=[{caption:"Third",callback:function(){return console.log("called"),!0}}],o=e("button").on("click",function(){l.api.ui.showDialog(u,{},{primary:"Go",secondary:"Cancel",tertiary:r})}).append("Open dialog");return n.append(i),n.append(o),n}}]),t}(s.Component);t["default"]=d},function(e,t){e.exports=substance},function(e,t){e.exports=writer},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),r=a(i),o=writer,s=o.registerPlugin;t["default"]=function(){s?s(r["default"]):console.info("Register method not yet available")}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),r=a(i);t["default"]={name:"textanalyzer",id:"se.infomaker.textanalyzer",configure:function(e){e.addSidebarTab({id:"textanalyzer",name:"Textanalys"}),e.addComponentToSidebarWithTabId(this.id,"textanalyzer",r["default"])}}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=substance,s=o.Component,l=writer,u=l.api,d=l.event,c=function(e){function t(){var e;n(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];var s=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return u.events.on("textanalyzer",d.DOCUMENT_CHANGED,function(){s.calculateText()}),s}return i(t,e),r(t,[{key:"dispose",value:function(){u.events.off("textanalyzer",d.DOCUMENT_CHANGED)}}]),r(t,[{key:"calculateText",value:function(){var e=this.getCount();this.setState({textLength:e.textLength,words:e.words})}},{key:"render",value:function(e){var t=e("div").addClass("sc-information-panel plugin").append(e("h2").append("Text")),n=e("div").addClass("number__container clearfix"),a=e("div").addClass("count-info").append(e("span").append(this.state.textLength.toString())).append(e("p").append("Tecken")).attr("title","Tecken"),i=e("div").addClass("count-info").append(e("span").append(this.state.words.toString())).append(e("p").append("Ord")).attr("title","Ord");return n.append([a,i]),t.append(n),t}},{key:"getInitialState",value:function(){var e=this.getCount();return{textLength:e.textLength,words:e.words}}},{key:"getCount",value:function(){var e=u.document.getDocumentNodes(),t="";e.forEach(function(e){e.content&&(t+=e.content.trim())});var n=t.split(/\s+/),a=t.length;return{words:n.length,textLength:a}}}]),t}(s);t["default"]=c},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),n(10);var i=n(14),r=a(i),o=writer,s=o.registerPlugin;t["default"]=function(){s?s(r["default"]):console.error("Could not register plugin")}},function(e,t){},,,,function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(15),r=a(i),o=n(16),s=a(o),l=n(17),u=a(l);t["default"]={name:"preamble",id:"se.infomaker.preamble",configure:function(e){u["default"].type=this.name,s["default"].type=u["default"].type,s["default"].element=u["default"].type,e.addNode(u["default"]),e.addComponent(u["default"].type,r["default"]),e.addConverter("newsml",s["default"]),e.addTextType({name:this.name,data:{type:u["default"].type}}),e.addLabel("preamble.content",{en:"Preamble",sv:"Ingress"})}}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=substance,s=o.Component,l=o.TextPropertyComponent,u=function(e){function t(){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),r(t,[{key:"render",value:function(e){return e("div").addClass("sc-preamble").attr("data-id",this.props.node.id).append(e(l,{path:[this.props.node.id,"content"]}))}}]),t}(s);t["default"]=u},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={tagName:"element",matchElement:function(e){return e.is('element[type="preamble"]')},"import":function(e,t,n){t.content=n.annotatedText(e,[t.id,"content"])},"export":function(e,t,n){return t.attr("type","preamble").append(n.annotatedText([e.id,"content"]))}}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=substance,o=r.TextBlock,s=function(e){function t(){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),t}(o);s.define({id:{type:"string"}}),t["default"]=s},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(19),r=a(i),o=writer,s=o.registerPlugin;t["default"]=function(){s?s(r["default"]):console.log("Register method not yet available")}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(20),r=a(i);t["default"]={name:"publishflow",id:"se.infomaker.publishflow",configure:function(e){e.addPopover(this.id+"_1",{icon:"fa-ellipsis-h",button:!0,align:"right"},r["default"]),e.addLabel("Save",{sv:"Spara"}),e.addLabel("Save *",{sv:"Spara *"}),e.addLabel("imext:draft",{en:"Draft",sv:"Utkast"}),e.addLabel("imext:done",{en:"Ready for approval",sv:"Redo för godkännande"}),e.addLabel("stat:withheld",{en:"Scheduled for publication",sv:"Schemalagd för publicering"}),e.addLabel("stat:usable",{en:"Published",sv:"Publicerad"}),e.addLabel("stat:canceled",{en:"Unpublished",sv:"Avpublicerad"})}}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(21),u=a(l);n(22);var d=substance,c=d.Component,p=writer,f=p.api,h=p.moment,b=p.event,y="se.infomaker.publishflow",m=function(e){function t(){var e;i(this,t);for(var n=arguments.length,a=Array(n),o=0;o<n;o++)a[o]=arguments[o];var s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));return f.events.on(y,b.DOCUMENT_CHANGED,function(){s.props.popover.setButtonText(s.getLabel("Save *"))}),f.events.on(y,b.DOCUMENT_SAVED,function(){s._onDocumentSaved()}),s}return o(t,e),s(t,[{key:"dispose",value:function(){f.events.off(y,"document:changed"),f.events.off(y,"document:saved")}},{key:"getInitialState",value:function(){var e=f.newsItem.getPubStatus();return this.publishFlowMgr=new u["default"](y,f),{status:e,pubStart:f.newsItem.getPubStart(),pubStop:f.newsItem.getPubStop(),allowed:this.publishFlowMgr.getAllowedActions(e.qcode)}}},{key:"didMount",value:function(){this.props.popover.setButtonText(this.getLabel("Save")),this._updateStatus(),f.browser.isSupported()||this.props.popover.disable()}},{key:"render",value:function(e){var t=e("div").addClass("sc-np-publishflow").append(this.renderBody(e));return t}},{key:"renderBody",value:function(e){var t=this,n=e("div").addClass("sc-np-publish-body"),a=this.renderAllowedActions(e);switch(this.state.status.qcode){case"imext:draft":n.append([e("h2").append(this.getLabel("Publish article?")),e("p").append(this.getLabel("This article is currently an unpublished draft"))]);break;case"imext:done":n.append([e("h2").append(this.getLabel("Publish article?")),e("p").append(this.getLabel("Article is currently pending approval"))]);break;case"stat:withheld":n.append([e("h2").append(this.getLabel("Scheduled")),e("p").append(this.getLabel("Article is scheduled to be published")+" "+h(this.state.pubStart.value).fromNow())]);var i=e("p").append([this.getLabel("From")+": ",e("strong").append(h(this.state.pubStart.value).format("YYYY-MM-DD HH:mm"))]),r=h(this.state.pubStop);r.isValid()&&i.append([this.getLabel("To")+": ",e("strong").append(h(this.state.pubStop.value).format("YYYY-MM-DD HH:mm"))]),n.append(i);break;case"stat:usable":n.append([e("h2").append(this.getLabel("Republish article?")),e("p").append(this.getLabel("Article was published")+" "+h(this.state.pubStart.value).fromNow())]);break;case"stat:canceled":n.append([e("h2").append(this.getLabel("Publish article again?")),e("p").append(this.getLabel("Article has been canceled and is no longer published"))]);break;default:n.append([e("h2").append(this.getLabel("Unknown state")),e("p").append(this.getLabel("This article has an unknown, unsupported, status"))])}return n.append(a),n.append(e("div").css({"text-align":"right"}).append(e("button").addClass("btn-secondary").append(this.getLabel("Cancel")).on("click",function(){t.props.popover.close()}))),n}},{key:"renderAllowedActions",value:function(e){var t=this,n=e("div").addClass("sc-np-publish-actions");return this.publishFlowMgr.getAllowedActions(this.state.status.qcode).forEach(function(a){switch(a){case"imext:draft":n.append(t.renderActionDraft(e));break;case"imext:done":n.append(t.renderActionDone(e));break;case"stat:withheld":n.append(t.renderActionWithheld(e));break;case"stat:usable":n.append(t.renderActionUsable(e));break;case"stat:canceled":n.append(t.renderActionCanceled(e))}}),n}},{key:"renderActionDraft",value:function(e){var t=this;return e("a").append([e("i").addClass("fa fa-pencil"),e("span").append(this.getLabel("Save as draft"))]).on("click",function(){t.publishFlowMgr.setToDraft(),t.defaultAction()})}},{key:"renderActionDone",value:function(e){var t=this;return e("a").append([e("i").addClass("fa fa-check-circle-o"),e("span").append(this.getLabel("Ready for approval"))]).on("click",function(){t.publishFlowMgr.setToDone(),t.defaultAction()})}},{key:"renderActionWithheld",value:function(e){var t=this,n=e("div").addClass("sc-np-publish-action-section").ref("pfc-withheld");return n.append(e("a").append([e("i").addClass("fa fa-clock-o"),e("span").append(this.getLabel("Schedule for publish..."))]).addClass("more").on("click",function(){t.refs["pfc-withheld"].hasClass("active")?t.refs["pfc-withheld"].removeClass("active"):t.refs["pfc-withheld"].addClass("active")})),n.append(e("div").addClass("sc-np-publish-action-section-content sc-np-date-time").append([e("label").attr("for","pfc-lbl-withheld-from").append(this.getLabel("From")),e("input").attr({id:"pfc-lbl-withheld-from",type:"datetime-local",required:!0}).addClass("form-control").ref("pfc-lbl-withheld-from"),e("label").attr("for","pfc-lbl-withheld-to").append(this.getLabel("To")),e("input").attr({id:"pfc-lbl-withheld-to",type:"datetime-local"}).addClass("form-control").ref("pfc-lbl-withheld-to"),e("div").addClass("sc-np-publish-action-section-content-actions").append(e("button").addClass("btn-secondary").append(this.getLabel("Save"))).on("click",function(){try{t.publishFlowMgr.setToWithheld(t.refs["pfc-lbl-withheld-from"].val(),t.refs["pfc-lbl-withheld-to"].val()),t.defaultAction()}catch(e){return t.refs["pfc-lbl-withheld-from"].addClass("imc-flash"),window.setTimeout(function(){t.refs["pfc-lbl-withheld-from"].removeClass("imc-flash")},500),!1}})])),n}},{key:"renderActionUsable",value:function(e){var t=this,n=e("a");return"stat:usable"===this.state.status.qcode?n.append([e("i").addClass("fa fa-retweet"),e("span").append(this.getLabel("Republish article"))]):n.append([e("i").addClass("fa fa-send"),e("span").append(this.getLabel("Publish article"))]),n.on("click",function(){t.publishFlowMgr.setToUsable(),t.defaultAction()}),n}},{key:"renderActionCanceled",value:function(e){var t=this;return e("a").append([e("span").append(e("i").addClass("fa fa-ban"),this.getLabel("Unpublish article"))]).on("click",function(){t.publishFlowMgr.setToCanceled(),t.defaultAction()})}},{key:"defaultAction",value:function(){this.props.popover.disable(),this.props.popover.setIcon("fa-refresh fa-spin fa-fw"),f.newsItem.save()}},{key:"_onDocumentSaved",value:function(){this.props.popover.setButtonText(this.getLabel("Save")),this.props.popover.setIcon("fa-ellipsis-h"),this.props.popover.enable(),this.extendState({status:f.newsItem.getPubStatus(),pubStart:f.newsItem.getPubStart(),pubStop:f.newsItem.getPubStop()}),this._updateStatus()}},{key:"_updateStatus",value:function(){"stat:usable"===this.state.status.qcode?this.props.popover.setStatusText(this.getLabel(this.state.status.qcode)+" "+h(this.state.pubStart.value).fromNow()):"stat:withheld"===this.state.status.qcode?this.props.popover.setStatusText(this.getLabel(this.state.status.qcode)+" "+h(this.state.pubStart.value).fromNow()):this.props.popover.setStatusText(this.getLabel(this.state.status.qcode))}}]),t}(c);t["default"]=m},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=writer,r=i.api,o=i.moment,s=function(){function e(t){n(this,e),this.api=t,this.status={"imext:draft":{allowed:["imext:done","stat:usable","stat:withheld"]},"imext:done":{allowed:["stat:usable","imext:draft","stat:withheld"]},"stat:withheld":{allowed:["stat:usable","stat:canceled","imext:draft"]},"stat:usable":{allowed:["stat:usable","stat:canceled"]},"stat:canceled":{allowed:["imext:draft","imext:done","stat:usable","stat:withheld"]}}}return a(e,[{key:"getAllowedActions",value:function(e){return this.status[e]?this.status[e].allowed:[]}},{key:"setToDraft",value:function(){this.setStatus("imext:draft",null,null)}},{key:"setToDone",value:function(){this.setStatus("imext:done",null,null)}},{key:"setToWithheld",value:function(e,t){var n=o(e),a=o(t);if(!n.isValid())throw new Error("Invalid from date and time");this.setStatus("stat:withheld",{value:n.format("YYYY-MM-DDTHH:mm:ssZ")},a.isValid()?{value:a.format("YYYY-MM-DDTHH:mm:ssZ")}:null)}},{key:"setToUsable",value:function(){this.setStatus("stat:usable",{value:o().format("YYYY-MM-DDTHH:mm:ssZ")},null)}},{key:"setToCanceled",value:function(){this.setStatus("stat:canceled",null,null)}},{key:"setStatus",value:function(e,t,n){e&&r.newsItem.setPubstatus(this.pluginId,{qcode:e}),null===t?r.newsItem.removePubStart(this.pluginId):"undefined"!=typeof t&&r.newsItem.setPubStart(this.pluginId,t),null===n?r.newsItem.removePubStop(this.pluginId):"undefined"!=typeof n&&r.newsItem.setPubStop(this.pluginId,n)}}]),e}();t["default"]=s},function(e,t){},,function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),n(25);var i=n(27),r=a(i),o=writer,s=o.registerPlugin;t["default"]=function(){s?s(r["default"]):console.log("Register method not yet available")}},function(e,t){},,function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(28),r=a(i),o=n(29),s=a(o),l=n(30),u=a(l),d=n(31),c=a(d),p=n(32),f=a(p);t["default"]={name:"socialembed",id:"se.infomaker.socialembed",configure:function(e){e.addNode(f["default"]),e.addCommand("socialembed",s["default"]),e.addComponent(f["default"].type,r["default"]),e.addConverter("newsml",u["default"]),e.addMacro(c["default"])}}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=substance,s=o.Component,l=function(e){function t(){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),r(t,[{key:"render",value:function(e){var t,n=this.props.node,a=e("a").addClass("socialembed__container").addClass(n.socialChannel).attr("contenteditable",!1),i=e("div").append(e("div").append([e("strong").append(n.socialChannel).attr("contenteditable",!1),e("span").addClass("remove-button").append(this.context.iconProvider.renderIcon(e,"delete")).on("click",this.removeEmbed).attr("title",this.getLabel("Remove from article"))]).addClass("header").addClass(n.socialChannelIcon).attr("contenteditable",!1)),r=n.html;return t=e("div").addClass("socialembed__content").html(r),i.append(t),a.append(i),a}},{key:"removeEmbed",value:function(){this.context.api.document.deleteNode("socialembed",this.props.node)}}]),t}(s);l.noStyle=!0,t["default"]=l},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=substance,s=o.Command,l=function(e){function t(){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),r(t,[{key:"getCommandState",value:function(){return{disabled:!1}}},{key:"execute",value:function(e,t,n){return this.fetchEmbed(e.url,function(a,i){return a?n(a):(e.editorSession.selectNode(e.nodeId),t.api.document.insertBlockNode(i.type,i),void n(null))}),!0}},{key:"fetchEmbed",value:function(e,t){e.indexOf("twitter")>-1?this.loadTwitter(e,t):e.indexOf("instagram")>-1?this.loadInstagram(e,t):this.url.indexOf("facebook")>-1&&this.loadFacebook(e,t)}},{key:"loadTwitter",value:function(e,t){var n="https://api.twitter.com/1/statuses/oembed.json?id=",a=/status*\/(\d+)/.exec(e);$.ajax({url:n+a[1],dataType:"jsonp"}).done(function(e){var n={type:"socialembed",dataType:"x-im/socialembed",url:e.url,uri:"im://tweet/"+a[1],linkType:"x-im/tweet",html:e.html,author:e.author,socialChannel:"Twitter",socialChannelIcon:"fa-twitter"};t(null,n)}).fail(function(e,n){t(n)})}},{key:"isAsync",get:function(){return!0}}]),t}(s);t["default"]=l},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={type:"socialembed",tagName:"object",matchElement:function(e){return e.is('object[type="x-im/socialembed"]')},"import":function(e,t){t.dataType=e.attr("type");var n=e.find("links>link");t.url=n.attr("url"),t.uri=n.attr("uri"),t.linkType=n.attr("type"),t.html=n.innerHTML},"export":function(e,t,n){var a=n.$$;t.attr({id:e.id,type:e.dataType}),t.removeAttr("data-id");var i=a("links"),r=a("link");r.attr({rel:"self",type:e.linkType,url:e.url,uri:e.uri}),r.innerHTML=e.html,i.append(r),t.append(i)}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={execute:function(e,t){var n=t.editorSession,a=e.text;if("break"!==!e.action){var i=/^\s*(https?:\/\/([^\s]+))\s*$/.exec(a);if(i){var r=i[1];return n.executeCommand("socialembed",{nodeId:e.node.id,url:r}),!0}}}}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=substance,o=r.BlockNode,s=function(e){function t(){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),t}(o);s.define({type:"socialembed",dataType:"string",url:"string",uri:"string",linkType:{type:"string","default":""},title:{type:"string",optional:!0},html:{type:"string",optional:!0},author:{type:"string",optional:!0},socialChannel:{type:"string","default":""},socialChannelIcon:{type:"string","default":""}}),t["default"]=s},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(34),r=a(i),o=writer,s=o.registerPlugin;t["default"]=function(){s?s(r["default"]):console.info("Register method not yet available")}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),n(35);var i=n(37),r=a(i);t["default"]={name:"newspriority",id:"se.infomaker.newspriority",configure:function(e){e.addComponentToSidebarWithTabId(this.id,"main",r["default"]),e.addLabel("newsvalue",{en:"Newsvalue",sv:"Nyhetsvärde"}),e.addLabel("Lifetime",{en:"Lifetime",sv:"Livslängd"}),e.addLabel("enter-date-and-time",{en:"Enter date and time",sv:"Ange datum och tid"})}}},function(e,t){},,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=substance,s=o.Component,l=writer,u=l.api,d=l.moment,c=l.idGenerator,p=writer.lodash,f=p.isObject,h=p.isEmpty,b="se.infomaker.newspriority",y=function(e){function t(){var e;n(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];var s=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return u.events.on("newspriority","data:duplicated",function(){u.clearNewsPriority("newspriority"),s.rerender()}),s}return i(t,e),r(t,[{key:"getInitialState",value:function(){this.scores=u.getConfigValue(b,"scores"),this.lifetimes=u.getConfigValue(b,"lifetimes"),this.durationKey=u.getConfigValue(b,"durationKey"),this.defaultScoreIndex=u.getConfigValue(b,"defaultScoresIndex"),this.defaultLifetimeIndex=u.getConfigValue(b,"defaultLifetimesIndex");var e={score:this.scores[this.defaultScoreIndex].value,description:this.lifetimes[this.defaultLifetimeIndex].label,format:"lifetimecode"};return e[this.durationKey]=this.lifetimes[this.defaultLifetimeIndex].value,e}},{key:"updateState",value:function(){var e=u.newsItem.getNewsPriority(b);if(e)e.data.end&&!this.extendedState&&(this.extendedState={end:e.data.end});else{var t={$id:c(),$type:"x-im/newsvalue",data:{description:this.lifetimes[this.defaultLifetimeIndex].label,end:"",format:"lifetimecode",score:this.scores[this.defaultScoreIndex].value}};t.data[this.durationKey]=this.lifetimes[this.defaultLifetimeIndex].value,u.newsItem.setNewsPriority("newspriority",t),e=u.newsItem.getNewsPriority(b),f(e.data[this.durationKey])&&(e.data[this.durationKey]=t.data[this.durationKey])}if(Number(e.data.score)!==Number(this.state.score)){var n={score:e.data.score,description:e.data.description,format:e.data.format,end:e.data.end};n[this.durationKey]=e.data[this.durationKey],this.setState(n)}}},{key:"render",value:function(e){this.updateState();var t=e("div"),n=e("h2").text(this.getLabel("newsvalue"));t.append(n),t.append(this._renderPriority(e));var a=e("h2").text(this.getLabel("Lifetime"));return t.append(a),this.lifetimes.length>1&&t.append(this._renderLifeTime(e)),t.append(this._renderDatetimeInput(e).ref("datePickerComponent")),t}},{key:"_renderPriority",value:function(e){var t=e("div").addClass("btn-group"),n=this.scores.map(function(t){return e("button").addClass("btn btn-secondary").text(String(t.value)).attr("data-toggle","tooltip").attr("data-placement","bottom").attr("data-trigger","manual").attr("title",t.text).addClass(parseInt(this.state.score,10)===t.value?"active":"").on("click",function(){this.setNewsPriority(t.value)}.bind(this))}.bind(this));return t.append(n),t}},{key:"_renderLifeTime",value:function(e){var t=e("div").addClass("btn-group lifetime"),n=this.lifetimes.map(function(t){return e("button").addClass("btn btn-secondary").text(t.label).attr("data-toggle","tooltip").attr("data-placement","bottom").attr("data-trigger","manual").attr("title",t.text).addClass(this.state[this.durationKey]===t.value?"active":"").on("click",function(e){this.setLifetime(e,t)}.bind(this))}.bind(this));return t.append(n),t}},{key:"_renderDatetimeInput",value:function(e){var t=this,n=e("form").attr("id","npLifetimeForm"),a=e("fieldset").addClass("form-group").ref("datePickerFieldset"),i=this.getLabel("enter-date-and-time"),r=u.newsItem.getNewsPriority("newspriority").data.end;""===r||h(r)||(i="✓ "+i);var o=e("div").append(e("small").addClass("text-muted").text(i)).addClass("hidden").ref("datePickerInstructionText"),s=e("input").attr("type","datetime-local").addClass("form-control").attr("id","npLifetimeInput").on("change",this.setLifetimeDatetime).ref("datePickerInput");
return s.on("focus",function(){t.refs.datePickerInstructionText.el.removeClass("hidden")}),s.on("blur",function(){t.refs.datePickerInstructionText.el.addClass("hidden")}),this.state.end&&this.state.end.length>0&&s.val(this.state.end.substring(0,16)),"custom"!==this.state[this.durationKey]&&this.lifetimes.length>1&&n.attr("style","display: none;"),n.append(a.append(s).append(o)),n}},{key:"setNewsPriority",value:function(e){var t=u.newsItem.getNewsPriority(b);t.data.score=e,u.newsItem.setNewsPriority(b,t),this.extendState({score:t.data.score})}},{key:"setLifetime",value:function(e,t){for(var n=u.newsItem.getNewsPriority(b),a=0;a<this.lifetimes.length;a++)if(e.target.textContent===this.lifetimes[a].label){n.data.description=this.lifetimes[a].label,n.data[this.durationKey]=this.lifetimes[a].value;break}var i={};this.extendedState&&this.extendedState.end&&(i.end=this.extendedState.end),"custom"===t.value&&this.extendedState&&this.extendedState.end?n.data.end=this.extendedState.end:n.data.end="",u.newsItem.setNewsPriority("newspriority",n),i.description=n.data.description,i[this.durationKey]=n.data[this.durationKey],this.extendState(i)}},{key:"setLifetimeDatetime",value:function(e){var t=u.newsItem.getNewsPriority(b);""===e.target.value?t.data.end={}:t.data.end=d(e.target.value).format("YYYY-MM-DDTHH:mm:ssZ"),u.newsItem.setNewsPriority("newspriority",t),this.extendState({end:t.data.end})}}]),t}(s);t["default"]=y}]);